package script.db

databaseChangeLog(logicalFilePath: 'script/db/${tableName}.groovy') {
    changeSet(author: "${author}", id: "${datetime}-${tableName}") {
    if(helper.dbType().isSupportSequence()){
            createSequence(sequenceName: '${tableName}_s', startValue:"1")
        }
        createTable(tableName: "${tableName}", remarks: "${tableComment}") {
#foreach ($column in $columns)
        column(name: "$column.columnName", type: "$column.columnType",#if($column.extra == "auto_increment") autoIncrement: true , #end #if($column.columnDefault != "NULL") #if($column.columnType == "datetime") defaultValueComputed:"$column.columnDefault", #else defaultValue:"$column.columnDefault", #end #end remarks: "$column.comments") #if(${pkCnt} == 1 && $pk.columnName == $column.columnName) {constraints(primaryKey: true)} #else #if($column.nullAble == 'NO'){constraints(nullable:"false")} #end #end

#end

    }
#foreach ($index in $indexs)
#if($index.indexType == "N")
   createIndex(tableName: "$index.tableName", indexName: "$index.indexName") {
     #foreach ($indexCol in $index.indexColumns)
       column(name: "$indexCol")
     #end
   }          
#end
#end

#foreach ($index in $indexs)
#if($index.indexType == "U")
   addUniqueConstraint(columnNames:"$index.indexColumn",tableName:"$index.tableName",constraintName: "$index.indexName")   
#elseif($index.indexType == "P" && ${pkCnt} > 1)
   addPrimaryKey(columnNames:"$index.indexColumn",tableName:"$index.tableName",constraintName: "$index.indexName")        
#end
#end
  }    
}